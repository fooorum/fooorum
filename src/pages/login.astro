---
import Layout from "@layouts/Layout.astro";
import Stack from "@components/feeds/Stack.astro";
import { userNameValidator, passwordValidator } from "@lib/validate";
import { Icon } from "astro-icon/components";

const { session } = Astro.locals;
if (session) {
  return Astro.redirect("/logout");
}
---

<Layout title="Anmelden oder Registrieren">
  <form method="post" action="/api/login" autocomplete="on" data-astro-reload>
    <Stack>
      <label for="username">Nutzername</label>
      <input
        id="username"
        name="username"
        required
        {...userNameValidator.toJSON()}
      />
      <label for="password">Passwort</label>
      <input
        id="password"
        name="password"
        type="password"
        required
        {...passwordValidator.toJSON()}
      />
      <button><Icon name="mdi:login" /> Anmelden oder registrieren</button>
    </Stack>
  </form>
</Layout>
